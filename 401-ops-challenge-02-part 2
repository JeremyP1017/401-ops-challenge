import smtplib
import datetime
import time
import socket

# Function to send email notification
def send_notification(from_address, to_address, password, subject, body):
    try:
        server = smtplib.SMTP('smtp.gmail.com', 587)
        server.starttls()
        server.login(from_address, password)
        message = 'Subject: {}\n\n{}'.format(subject, body)
        server.sendmail(from_address, to_address, message)
        print("Notification sent successfully")
    except Exception as e:
        print("Notification could not be sent. Error: ", str(e))
    finally:
        server.quit()

# Ask for user's email address and password
from_address = input("Enter your email address: ")
password = input("Enter your email password: ")

# Set the email recipient address
to_address = "administrator@example.com"

# Set the initial host status
host_status = False

while True:
    # Ping the host to check its status
    hostname = "example.com"  # Replace with the host you want to ping
    response = os.system("ping -n 1 " + hostname)
    
    # Check if the host status has changed
    if response == 0 and not host_status:
        subject = "Host status changed"
        body = "{} is now up at {}".format(hostname, datetime.datetime.now())
        host_status = True
        send_notification(from_address, to_address, password, subject, body)
    elif response != 0 and host_status:
        subject = "Host status changed"
        body = "{} is now down at {}".format(hostname, datetime.datetime.now())
        host_status = False
        send_notification(from_address, to_address, password, subject, body)

    time.sleep(60)  # Wait for 60 seconds before checking again
